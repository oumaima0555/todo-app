<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Todo App{% endblock %}</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ asset('css/index.css') }}">

    {% block stylesheets %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">
<div class="container app-container" style="max-width: 900px;">

    {% block theme_toggle %}
    <header class="header-modern">
        <div class="brand-icon">
            <i class="bi bi-check2-square"></i>
        </div>
        <div>
            <h2 class="m-0" style="font-weight: 800; letter-spacing: -1px;">Todo App</h2>
            <small class="text-secondary fw-semibold">Workspace</small>
        </div>
        
        <div class="ms-auto d-flex align-items-center gap-3">
            {% if app.user %}
                <a href="{{ path('app_logout') }}" class="theme-toggle-btn text-decoration-none" title="Se dÃ©connecter">
                    <i class="bi bi-box-arrow-right"></i>
                </a>
            {% endif %}
            <button id="theme-toggle" class="theme-toggle-btn">
                <i class="bi bi-moon-stars-fill" id="theme-icon"></i>
            </button>
        </div>
    </header>
    {% endblock %}

    {% block body %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{% block theme_script %}
<script>
    const themeToggle = document.getElementById('theme-toggle');

    if (themeToggle) {
        const themeIcon = document.getElementById('theme-icon');
        const body = document.body;

        const currentTheme = localStorage.getItem('theme') || 'light';
        body.classList.add(currentTheme + '-theme');

        if (currentTheme === 'dark') {
            themeIcon.classList.replace('bi-moon-fill', 'bi-sun-fill');
        }

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-theme');
            body.classList.toggle('light-theme');

            const isDark = body.classList.contains('dark-theme');
            themeIcon.className = isDark ? 'bi bi-sun-fill' : 'bi bi-moon-fill';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
    }
</script>
{% endblock %}

</body>
</html>

